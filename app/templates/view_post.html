<!-- view_post.html -->
{% extends 'base.html' %}

<!-- Post -->
{% block content %}
<div class="post-view" data-post-id="{{ post.id }}">
  <h6>{{ post.author.first_name }} {{ post.author.family_name }}</h6>
  <h3>{{ post.title }}</h3>
  <p>{{ post.content }}</p>
  <div class="like-btn {{ 'active' if post.id in liked_post_ids else '' }}">
    <i class="fa-solid fa-heart fa-lg"></i>
  </div>
  <small class="like-count">{{ post.likers|length }}</small><br>
  <small>{{ post.date_posted.strftime('%Y-%m-%d %H:%M') }}</small>
  <hr>
</div>

<hr>

<!-- Comment section -->
<h3>Comments:</h3>

{% for comment in comments %}

<div class="comment" data-comment-id="{{ comment.id }}">

  <h6>{{ comment.author.first_name }} {{ comment.author.family_name }}</h6>
  <!-- Comment display area -->
  <p class="comment-content">{{ comment.content }}</p>

  <!-- Comment edit area (hidden initially) -->
  <textarea class="form-control edit-comment-content" style="display: none;">{{ comment.content }}</textarea>

  <small>Commented on: {{ comment.date_posted.strftime('%Y-%m-%d %H:%M') }}</small>

  <!-- Edit and delete buttons -->
  {% if current_user == comment.author %}
  <button class="edit-btn btn"><i class="fas fa-edit fa-lg"></i></button>
  <button class="delete-btn btn"><i class="fas fa-trash-alt fa-lg"></i></button>
  <button class="save-edit-btn btn" style="display: none;">Save</button>
  <button class="cancel-edit-btn btn" style="display: none;">Cancel</button>
  {% endif %}


</div>

{% endfor %}

<hr>

<h3>Add a Comment:</h3>
<form action="{{ url_for('main.view_post', post_id=post.id) }}" method="post">
  {{ form.hidden_tag() }}
  <div class="form-group">
    {{ form.content.label }}
    {{ form.content(rows=3, class_='form-control') }}
  </div>
  {{ form.submit(class_='btn btn-primary') }}
</form>
{% endblock %}
